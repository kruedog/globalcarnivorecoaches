<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Carnivore Coaches | Durability. Focus. Freedom.</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --blue:#192168;
  --red:#AF1E2D;
  --white:#fff;
  --shadow:0 8px 40px rgba(0,0,0,.25);
  --radius:18px;
}

body {
  margin:0;
  font-family:'Inter',sans-serif;
  color:var(--blue);
  background:radial-gradient(circle at 10% 10%,#F8F9FA 0%,#D0D2D5 40%,#B0B3BA 100%);
}

header {
  text-align:center;
  padding:3rem 1rem 2rem;
}
h1 {
  font-family:'Cinzel',serif;
  font-size:3rem;
  margin:0;
}
.coaches-wrap {
  max-width:1200px;
  margin:auto;
  padding:2rem 1rem 5rem;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:2rem;
}
.card {
  background:rgba(255,255,255,.8);
  padding:1rem;
  border-radius:var(--radius);
  text-align:center;
  border:3px solid var(--blue);
  box-shadow:var(--shadow);
  cursor:pointer;
  transition:.3s;
}
.card:hover { transform:translateY(-5px); }
.card img {
  width:100%;
  height:240px;
  object-fit:cover;
  border-radius:var(--radius);
  border:4px solid var(--red);
}
.card h3 {
  font-family:'Cinzel',serif;
  margin:.7rem 0 .3rem;
  font-size:1.3rem;
}
.card p { margin:0 0 .8rem; }

/*** PUBLIC PROFILE MODAL ***/
#coachModal {
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:13000;
  background:rgba(255,255,255,.55);
  backdrop-filter:blur(8px);
  padding:2rem;
}
#coachModal.active { display:flex; }

.modal-box {
  background:rgba(255,255,255,.95);
  width:95%;
  max-width:900px;
  border-radius:var(--radius);
  border:6px solid var(--red);
  box-shadow:0 40px 80px rgba(0,0,0,.4);
  padding:0;
  overflow:hidden;
  position:relative;
}

.modal-close {
  position:absolute;
  top:1rem;
  right:1.5rem;
  color:var(--blue);
  font-size:3rem;
  text-decoration:none;
  font-weight:700;
  cursor:pointer;
  transition:.2s;
}
.modal-close:hover { color:var(--red); }

.modal-head {
  padding:2.8rem 2.5rem 1rem;
  text-align:center;
}
.modal-head h2 {
  font-family:'Cinzel',serif;
  margin:.3rem 0 .2rem;
  color:var(--red);
  font-size:2rem;
}
.modal-head p {
  margin:0;
  font-size:1.1rem;
  color:#333;
}

.modal-avatar {
  width:180px;
  height:180px;
  margin:1rem auto 1.8rem;
  border-radius:50%;
  border:5px solid var(--blue);
  overflow:hidden;
  box-shadow:0 12px 45px rgba(0,0,0,.35);
}
.modal-avatar img {
  width:100%; height:100%; object-fit:cover;
}

.modal-body {
  padding:2rem 2.5rem;
}
.modal-body h3 {
  font-family:'Cinzel',serif;
  font-size:1.5rem;
  margin:1.5rem 0 .8rem;
  color:var(--red);
}
.modal-body p {
  white-space:pre-wrap;
  line-height:1.65;
  font-size:1.1rem;
}

.ba-box {
  display:flex;
  gap:1rem;
  flex-wrap:wrap;
  margin-top:1rem;
}
.ba-box img {
  width:200px;
  height:280px;
  object-fit:cover;
  border-radius:var(--radius);
  border:4px solid var(--blue);
  box-shadow:0 12px 40px rgba(0,0,0,.4);
}

.spec-list {
  list-style:none;
  padding:0;
  margin:0;
}
.spec-list li {
  text-align:center;
  background:var(--blue);
  color:#fff;
  padding:.4rem .9rem;
  margin:.3rem auto;
  border-radius:20px;
  font-size:1rem;
  font-weight:600;
  max-width:200px;
}

.book-btn {
  display:block;
  width:100%;
  background:var(--red);
  color:#fff;
  font-size:1.2rem;
  padding:1rem;
  border:none;
  cursor:pointer;
  margin-top:2rem;
  border-radius:999px;
  box-shadow:0 15px 45px rgba(175,30,45,.45);
}
.book-btn:hover {
  background:#901626;
}
</style>
</head>
<body>

<header>
  <h1>Our Coaches</h1>
</header>

<div class="coaches-wrap" id="coachGrid"></div>

<!-- PUBLIC PROFILE MODAL -->
<div id="coachModal">
  <div class="modal-box">
    <a class="modal-close" id="modalClose">&times;</a>
    <div class="modal-head">
      <div class="modal-avatar"><img id="mAvatar"></div>
      <h2 id="mName">Coach Name</h2>
      <p id="mEmail"></p>
    </div>
    <div class="modal-body">
      <h3>About Me</h3>
      <p id="mBio"></p>

      <h3>Before / After</h3>
      <div class="ba-box" id="mBA"></div>

      <h3>Specializations</h3>
      <ul class="spec-list" id="mSpecs"></ul>

      <button class="book-btn">Book This Coach</button>
    </div>
  </div>
</div>

<script>
const API_BASE = '/webapi/';
function imgUrl(filename) {
  return filename ? `/uploads/${filename}` : '/images/earth_steak.png';
}

// Load all coaches for grid
async function loadCoaches() {
  try {
    const res = await fetch(`${API_BASE}get_coaches.php`);
    const data = await res.json();
    const grid = document.getElementById('coachGrid');
    grid.innerHTML = '';

    if (!data.success || !Array.isArray(data.coaches)) return;

    data.coaches.forEach(c => {
      const div = document.createElement('div');
      div.className = 'card';
      div.onclick = () => openModal(c.Username);

      div.innerHTML = `
        <img src="${imgUrl(c.Files?.Profile)}" alt="">
        <h3>${c.CoachName || c.Username}</h3>
        <p>${c.Specializations?.length ? c.Specializations.join(', ') : ''}</p>
      `;

      grid.appendChild(div);
    });
  } catch(e){ console.error(e); }
}

// Open profile modal
async function openModal(username) {
  const res = await fetch(`${API_BASE}get_coach.php?username=${encodeURIComponent(username)}`);
  const data = await res.json();
  if (!data.success) return alert('Coach not found');

  const c = data.coach;

  document.getElementById('mName').textContent = c.CoachName || c.Username;
  document.getElementById('mEmail').textContent = c.Email || '';
  document.getElementById('mAvatar').src = imgUrl(c.Files?.Profile);
  document.getElementById('mBio').textContent = c.Bio || 'No bio yet';

  const mBA = document.getElementById('mBA');
  mBA.innerHTML='';
  ['Before','After'].forEach(t=>{
    if (c.Files?.[t]) {
      const img = document.createElement('img');
      img.src = imgUrl(c.Files[t]);
      mBA.appendChild(img);
    }
  });

  const mSpecs = document.getElementById('mSpecs');
  mSpecs.innerHTML='';
  if (c.Specializations?.length) {
    c.Specializations.forEach(s=>{
      const li = document.createElement('li');
      li.textContent = s;
      mSpecs.appendChild(li);
    });
  }

  document.getElementById('coachModal').classList.add('active');
}

document.getElementById('modalClose').onclick = () =>
  document.getElementById('coachModal').classList.remove('active');

loadCoaches();
</script>

</body>
</html>
