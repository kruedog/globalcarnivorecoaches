<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Coach Login • Global Carnivore Coaches</title>

<link rel="icon" type="image/png" href="/images/earth_steak.png">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700&family=Inter:wght@300;500;700&display=swap" rel="stylesheet">

<style>
:root {
  --white:#FFFFFF;
  --parch:#D0D2D5;
  --blue:#192168;
  --red:#AF1E2D;
  --muted:#585858;
  --radius:16px;
  --shadow:0 16px 40px rgba(0,0,0,.22);
}

* { box-sizing:border-box; margin:0; padding:0; }

body {
  font-family:'Inter',sans-serif;
  background:radial-gradient(circle at 10% 10%,#F8F9FA 0%,var(--parch) 40%,#B0B3BA 100%);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:2rem 1rem;
  color:var(--blue);
}

.login-card {
  background:var(--white);
  padding:2.5rem 2rem;
  width:100%;
  max-width:420px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  border:1px solid rgba(0,0,0,0.06);
  animation:fadeIn .4s ease;
}

@keyframes fadeIn {
  from {opacity:0; transform:translateY(10px);}
  to {opacity:1; transform:translateY(0);}
}

.logo-wrap {
  text-align:center;
  margin-bottom:1rem;
}
.logo-wrap img {
  width:90px; height:90px;
}

h1 {
  text-align:center;
  font-family:'Cinzel',serif;
  margin-bottom:.4rem;
  font-size:2.1rem;
  color:var(--blue);
}
p.sub {
  text-align:center;
  font-size:.95rem;
  color:var(--muted);
  margin-bottom:2rem;
}

label {
  display:block;
  font-size:.9rem;
  font-weight:600;
  margin-bottom:.35rem;
  color:var(--blue);
}

input {
  width:100%;
  padding:.9rem 1rem;
  border:2px solid #c7cbe0;
  border-radius:var(--radius);
  transition:border .18s, box-shadow .18s;
  font-size:1rem;
  background:#fff;
  color:var(--blue);
  margin-bottom:1.3rem;
}
input:focus {
  border-color:var(--red);
  outline:none;
  box-shadow:0 0 0 3px rgba(175,30,45,0.22);
}

.btn {
  display:inline-block;
  width:100%;
  margin-top:.3rem;
  padding:1rem;
  font-weight:700;
  border:none;
  border-radius:999px;
  cursor:pointer;
  font-size:1rem;
  transition:all .22s;
}

.btn-primary {
  background:var(--red);
  color:#fff;
  box-shadow:0 8px 26px rgba(175,30,45,.35);
}
.btn-primary:hover {
  background:#8b1624;
  transform:translateY(-2px);
}

.status-line {
  text-align:center;
  min-height:22px;
  font-size:.9rem;
  margin-top:1rem;
}
.status-line.ok { color:green; }
.status-line.err { color:var(--red); }

footer {
  text-align:center;
  margin-top:1.5rem;
}
footer a {
  color:var(--blue);
  font-size:.85rem;
  text-decoration:none;
}
footer a:hover {
  text-decoration:underline;
}
</style>
</head>

<body>
<div class="login-card">
  <div class="logo-wrap">
    <img src="/images/earth_steak.png" alt="Global Carnivore Coaches Logo">
  </div>

  <h1>Coach Login</h1>
  <p class="sub">Enter your credentials to access your profile</p>

  <form id="loginForm" autocomplete="on">
    <label for="username">Username</label>
    <input id="username" name="username" required autocomplete="username">

    <label for="password">Password</label>
    <input id="password" name="password" type="password" required autocomplete="current-password">

    <button type="submit" class="btn btn-primary">Sign In</button>

    <div id="loginStatus" class="status-line"></div>
  </form>

  <footer>
    <a href="/">← Return to Homepage</a>
  </footer>
</div>

<script>
const API_BASE = window.location.origin + '/webapi/';

function setStatus(msg, ok=true){
  const el = document.getElementById('loginStatus');
  el.textContent = msg || '';
  el.className = 'status-line ' + (msg ? (ok ? 'ok' : 'err') : '');
}

// Auto-redirect if already logged in
(async()=>{
  try{
    const r = await fetch(API_BASE+'login.php',{
      method:'GET',
      credentials:'include',
      cache:'no-store'
    });
    const j = await r.json();
    if(j.success){
      window.location.href='/profile.html';
    }
  }catch{}
})();

// Main login submission
document.getElementById('loginForm').addEventListener('submit',async(e)=>{
  e.preventDefault();
  setStatus('Signing in…', true);

  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;

  try{
    const r = await fetch(API_BASE+'login.php',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      credentials:'include',
      body:JSON.stringify({ username, password })
    });
    const j = await r.json();

    if(!j.success){
      setStatus(j.message || 'Login failed', false);
      return;
    }

    localStorage.setItem('username', username);
    if(j.role) localStorage.setItem('role', j.role.toLowerCase());

    setStatus('Login successful!', true);
    setTimeout(()=>window.location.href='/profile.html', 350);
  }
  catch(err){
    console.error(err);
    setStatus('Network error — try again.', false);
  }
});
</script>

</body>
</html>
