<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Coach Login | Global Carnivore Coaches</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lora&display=swap" rel="stylesheet">
<style>
:root{--primary:#C51230;--accent:#192168;--bg:#fff}
body{font-family:'Lora',serif;background:var(--bg);color:var(--accent);margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem}
.container{max-width:420px;background:#fff;padding:1.8rem;border:2px solid var(--accent);border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.08)}
h2{font-family:'Cinzel',serif;color:var(--primary);text-align:center;margin:0 0 1rem}
input{width:100%;padding:.75rem;margin:.5rem 0;border:1px solid var(--accent);border-radius:4px}
button{width:100%;padding:.75rem;background:var(--primary);color:#fff;border:none;border-radius:4px;cursor:pointer;font-family:'Cinzel',serif;margin-top:0.5rem}
#homeBtn{background:#192168;}
#loginMsg{margin-top:1rem;text-align:center;color:red}
.forgot-msg{display:block;text-align:center;margin-top:.75rem;color:var(--accent);font-style:italic}
</style>
</head>
<body>
<div class="container">
  <h2>Coach Login</h2>
  <form id="loginForm" autocomplete="off">
    <input type="text" id="username" placeholder="Username" required />
    <input type="password" id="password" placeholder="Password" required />
    <button type="submit">Login</button>
    <button type="button" id="homeBtn">Home</button>
  </form>
  <div class="forgot-msg">
   
  </div>
  <div id="loginMsg"></div>
</div>

<script>
// Determine API base depending on hostname
let API_BASE;
if (window.location.hostname === 'kruedog.ddns.net') {
  API_BASE = window.location.protocol === 'https:'
    ? 'https://kruedog.ddns.net:477/webapi'
    : 'http://kruedog.ddns.net:8080/webapi';
} else {
  API_BASE = 'http://192.168.1.2:8080/webapi';
}

// Login form
const form = document.getElementById('loginForm');
form.addEventListener('submit', async e => {
  e.preventDefault();
  const loginMsg = document.getElementById('loginMsg');
  loginMsg.textContent = '';

  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;

  if (!username || !password) { loginMsg.textContent = 'Enter username and password'; return; }

  const btn = form.querySelector('button[type="submit"]');
  btn.disabled = true; btn.textContent = 'Logging in...';

  try {
    const res = await fetch(`${API_BASE}/login.php`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({username, password}),
      credentials: 'same-origin'
    });
    const json = await res.json();
    if (json.success) {
      localStorage.setItem('username', json.username);
      localStorage.setItem('coachName', json.CoachName || json.username);
      localStorage.setItem('email', json.email || '');
      window.location.href = 'profile.html';
    } else loginMsg.textContent = json.message || 'Login failed';
  } catch (err) { loginMsg.textContent = 'Network error: ' + err.message; }
  finally { btn.disabled = false; btn.textContent = 'Login'; }
});

// Home button
document.getElementById('homeBtn').addEventListener('click', () => {
  window.location.href = 'http://kruedog.ddns.net:8080/index.html';
});
</script>
</body>
</html>