<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Coach Login • Global Carnivore Coaches</title>

  <link rel="icon" type="image/png" href="../images/earth_steak.png">
  <link rel="stylesheet" href="../css/global.css">

  <style>
    body {
:root {
  --white:#fff;
  --text:#192168;
  --blue:#192168;
  --red:#AF1E2D;
  --muted:#555;
  --radius:14px;
  --shadow:0 12px 40px rgba(0,0,0,.18);
}

body {
  min-height:100vh;
  font-family:'Inter',sans-serif;
  background:radial-gradient(circle at 10% 10%,#F8F9FA 0%,#D0D2D5 40%,#B0B3BA 100%);
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:2rem 1rem;
}

.login-card {
  width:100%;
  max-width:420px;
  background:var(--white);
  border-radius:var(--radius);
  padding:2.4rem 2rem;
  box-shadow:var(--shadow);
  border:1px solid rgba(0,0,0,0.06);
}

h1 {
  font-family:'Cinzel',serif;
  color:var(--blue);
  font-size:2rem;
  margin-bottom:.6rem;
  text-align:center;
}

p.sub {
  text-align:center;
  color:var(--muted);
  margin-bottom:2rem;
}

label {
  display:block;
  font-size:.9rem;
  font-weight:600;
  margin-bottom:.3rem;
}

input {
  width:100%;
  padding:.9rem 1rem;
  border:2px solid #ccd;
  border-radius:var(--radius);
  font-size:1rem;
  margin-bottom:1.2rem;
  background:#fff;
  color:var(--blue);
  transition:all .18s ease-in-out;
}

input:focus {
  border-color:var(--red);
  box-shadow:0 0 0 3px rgba(175,30,45,0.25);
  outline:none;
}

.btn {
  width:100%;
  padding:1rem;
  border-radius:999px;
  font-weight:700;
  border:none;
  cursor:pointer;
  font-size:1rem;
  transition:all .2s;
  margin-top:.25rem;
}

.btn-primary {
  background:var(--red);
  color:#fff;
  box-shadow:0 6px 22px rgba(175,30,45,.35);
}

.btn-primary:hover {
  background:#8b1624;
  transform:translateY(-1px);
}

.status-line {
  text-align:center;
  margin-top:1rem;
  min-height:18px;
  font-size:.9rem;
}

.status-line.err { color:var(--red); }
.status-line.ok  { color:green; }

    }
  </style>
</head>

<body>

  <div class="login-box">
    <h2>Coach Login</h2>

    <label for="username">Username</label>
    <input id="username" name="username" autocomplete="username" required />

    <label for="password">Password</label>
    <input id="password" name="password"
           type="password" autocomplete="current-password" required />

    <button class="btn" id="loginBtn">Login</button>

    <div id="error-msg"></div>
  </div>

  <script>
    const API_BASE = window.location.origin + "/webapi/";

    async function checkSession() {
      try {
        const res = await fetch(API_BASE + "login.php", {
          method: "GET",
          credentials: "include",
          cache: "no-store"
        });
        const data = await res.json();
        if (data && data.success) {
          setTimeout(() => window.location.href = "/webapi/profile.html", 150);
        }
      } catch (_) {}
    }
    checkSession();

    document.getElementById("loginBtn").onclick = async () => {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const err = document.getElementById("error-msg");
      err.textContent = "";

      if (!username || !password) {
        err.textContent = "Enter username and password.";
        return;
      }

      try {
        const res = await fetch(API_BASE + "login.php", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          credentials: "include",
          body: JSON.stringify({username, password})
        });

        const data = await res.json();

        if (!data.success) {
          err.textContent = data.message || "Login failed";
          return;
        }

        localStorage.setItem("username", data.username);
        localStorage.setItem("role", (data.role || "coach").toLowerCase());

        setTimeout(() => {
          window.location.href = "/webapi/profile.html";
        }, 150);

      } catch (error) {
        console.error(error);
        err.textContent = "Server error — try again";
      }
    };
  </script>

</body>
</html>
